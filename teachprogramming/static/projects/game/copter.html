<!DOCTYPE html><html>
<head>
    <meta charset="utf-8" />
    <link id="favicon" rel="shortcut icon" type="image/png" href="data:image/png;base64,....==" />
</head><body></body>
<script type="module">
import {CanvasAnimationBase, Gfx, createFullScreenCanvasElement} from './animation_base.js'

class Copter extends CanvasAnimationBase {
    constructor() {
        super(...arguments)
        this.load_image("copter_image", "images/ship.gif")
        this.level_number = 1
        this.load_level()
    }
    load_level() {
        this.load_image(`background_2`, `images/CopterLevel${this.level_number}_layer2.png`)
        this.load_image(`background_1`, `images/CopterLevel${this.level_number}_layer1.png`)
        this.load_image(`background_0`, `images/CopterLevel${this.level_number}.png`)
        this.reset()
    }
    reset() {
        this.background_x_pos = 0
        this.copter_x_pos = 50
        this.copter_y_pos = 100
        this.copter_x_vel = 0
        this.copter_y_vel = 0
    }
    model_inc(frame) {
        this.background_x_pos += 1   // VER: background
                                     // VER: background
        //if (this.keys_pressed.has('Space')) {self.copter_y_pos += -2}  // VER: copter NOT physics
        //else                                {self.copter_y_pos +=  1}  // VER: copter NOT physics
        if (this.keys_pressed.has('ArrowUp'))    {this.copter_y_vel += -0.1} // VER: physics
        if (this.keys_pressed.has('ArrowDown'))  {this.copter_y_vel +=  0.1} // VER: physics
        if (this.keys_pressed.has('ArrowLeft'))  {this.copter_x_vel += -0.1} // VER: physics HIDE
        if (this.keys_pressed.has('ArrowRight')) {this.copter_x_vel +=  0.1} // VER: physics HIDE
                                                       // VER: copter
        this.copter_x_vel  = this.copter_x_vel * 0.99  // VER: physics
        this.copter_y_vel  = this.copter_y_vel * 0.99  // VER: physics
        this.copter_y_vel += 0.025                     // VER: physics
        this.copter_x_pos += this.copter_x_vel         // VER: physics
        this.copter_y_pos += this.copter_y_vel         // VER: physics
                                                       // VER: physics
        //if (true) {                                  // VER: collision_single NOT collision_multi
        if (true) {
            // TODO: collision
        }
    }
    draw(context, frame) {
        this.clear()
        //context.drawImage(this.images['background_0'], -this.background_x_pos, 0)
        for (let layer of [2,1,0]) { // VER: parallax
            context.drawImage(this.images[`background_${layer}`], Math.round(-this.background_x_pos/Math.pow(2,layer)), 0) // VER: parallax
        } // VER: parallax
        context.drawImage(this.images['copter_image'], Math.round(this.copter_x_pos), Math.round(this.copter_y_pos)) // VER: copter
    }
}

(new Copter(createFullScreenCanvasElement({width:640, height:360}))).setRunning(true)
</script></html>
